workload:
  nodes: 2
  image: "us-central1-docker.pkg.dev/supercomputer-testing/sufkha-registry/pytorch-kueue-job:latest"
  torchRunTarget: "/workspace/pytorch_example.py"

tcpx:
  enabled: "true"
  repository: "us-docker.pkg.dev/gce-ai-infra/gpudirect-tcpx"
  daemonVersion: "tcpgpudmarxd-dev:v2.0.9"
  pluginVersion: "nccl-plugin-gpudirecttcpx-dev:v3.1.6_2023_10_06"
 
  ncclSettings:
  - name: NCCL_DEBUG
    value: "VERSION"
 
  # The following NCCL settings are recommended (but tunable):
  - name: NCCL_MIN_NCHANNELS
    value: "8"
  - name: NCCL_MAX_NCHANNELS
    value: "8"
  - name: NCCL_SOCKET_NTHREADS
    value: "1"
  - name: NCCL_NSOCKS_PERTHREAD
    value: "4"
